var _0x44d9=['params','validators','routine','then','routines','response','errors','log','formatters','updateRoutine','api.validators.routineId','body','routineId','update','result','catch','handle','stringify','info','deleteRoutine','delete','retrieveRoutines','Retrieve\x20all\x20routines','retrieveAll','retrieveRooutines','retrieveRoutine','retrieveById','executeRoutine','Executes\x20a\x20specific\x20routine','invalid\x20routine\x20id\x20\x22','warning','utils','actions','invalid\x20device\x20id\x20\x22','deviceId','deviceTypes','typeId','state','actionName','invalid\x20action\x20name\x20\x22','\x22\x20for\x20device\x20id\x20\x22','length','getInternalState','devices','models','toISOString','deviceLogs','create','filter','forEach','message','push','codes','constraint','name','string','good\x20night','[{\x20\x22deviceId\x22:\x20\x22c39181d52abe5555\x22,\x20\x22actionName\x22:\x20\x22turnOff\x22,\x20\x22params\x22:\x20[],\x20\x22meta\x22:\x20\x22{}\x22\x20},\x20{\x20\x22deviceId\x22:\x20\x22f597c13717008fb1\x22,\x20\x22actionName\x22:\x20\x22armStay\x22,\x20\x22params\x22:\x20[\x221234\x22],\x20\x22meta\x22:\x20\x22{}\x22\x20}]','createRoutine','Creates\x20a\x20new\x20routine','webSocket','Routines','connection','rawConnection'];(function(_0x5102c3,_0xe49201){var _0x1877cc=function(_0x22699a){while(--_0x22699a){_0x5102c3['push'](_0x5102c3['shift']());}};_0x1877cc(++_0xe49201);}(_0x44d9,0xb6));var _0x4d0f=function(_0x1e3694,_0x3be69f){_0x1e3694=_0x1e3694-0x0;var _0x371c2a=_0x44d9[_0x1e3694];return _0x371c2a;};'use strict';const modelSchema={'title':'routine','required':[_0x4d0f('0x0'),'actions'],'schema':{'name':{'type':_0x4d0f('0x1'),'example':_0x4d0f('0x2')},'actions':{'type':'object','example':_0x4d0f('0x3')},'meta':{'type':_0x4d0f('0x1'),'example':'{}'}}};exports[_0x4d0f('0x4')]={'name':_0x4d0f('0x4'),'description':_0x4d0f('0x5'),'blockedConnectionTypes':[_0x4d0f('0x6')],'version':0x1,'modelSchema':modelSchema,'outputExample':{},'tags':[_0x4d0f('0x7')],'run':function(_0x1f2865,_0xcface3,_0x198358){var _0x1fd778=_0xcface3[_0x4d0f('0x8')][_0x4d0f('0x9')][_0x4d0f('0xa')]['body'];_0x1f2865[_0x4d0f('0xb')][_0x4d0f('0xc')](_0x1fd778)[_0x4d0f('0xd')](_0x4625fc=>{return _0x1f2865[_0x4d0f('0xe')]['create'](_0x4625fc);})['then'](_0x2be804=>{_0xcface3[_0x4d0f('0xf')][_0x4d0f('0xc')]=_0x2be804;_0x198358();})['catch'](_0x140bd0=>{_0x198358(_0x1f2865[_0x4d0f('0x10')]['handle'](_0x140bd0));})[_0x4d0f('0xd')](()=>{_0x1f2865[_0x4d0f('0x11')](_0x1f2865[_0x4d0f('0x12')][_0x4d0f('0xf')]('createRoutine',JSON['stringify'](_0xcface3[_0x4d0f('0xf')])),'info');});}};exports[_0x4d0f('0x13')]={'name':_0x4d0f('0x13'),'description':'Updates\x20an\x20existing\x20routine','blockedConnectionTypes':['webSocket'],'version':0x1,'inputs':{'routineId':{'required':!![],'validator':_0x4d0f('0x14')}},'modelSchema':modelSchema,'outputExample':{},'tags':[_0x4d0f('0x7')],'run':function(_0x1d9500,_0x4bbd75,_0x46a4c1){var _0x58573a=_0x4bbd75[_0x4d0f('0x8')][_0x4d0f('0x9')][_0x4d0f('0xa')][_0x4d0f('0x15')];_0x1d9500[_0x4d0f('0xb')][_0x4d0f('0xc')](_0x58573a)[_0x4d0f('0xd')](_0x34f3d4=>{_0x34f3d4['id']=_0x34f3d4['id']||_0x4bbd75[_0x4d0f('0xa')][_0x4d0f('0x16')];return _0x1d9500['routines'][_0x4d0f('0x17')](_0x34f3d4);})['then'](_0x22100b=>{_0x4bbd75['response'][_0x4d0f('0x18')]=_0x22100b;_0x46a4c1();})[_0x4d0f('0x19')](_0x4c13f9=>{_0x46a4c1(_0x1d9500[_0x4d0f('0x10')][_0x4d0f('0x1a')](_0x4c13f9));})[_0x4d0f('0xd')](()=>{_0x1d9500['log'](_0x1d9500[_0x4d0f('0x12')][_0x4d0f('0xf')](_0x4d0f('0x13'),JSON[_0x4d0f('0x1b')](_0x4bbd75[_0x4d0f('0xf')])),_0x4d0f('0x1c'));});}};exports['deleteRoutine']={'name':_0x4d0f('0x1d'),'description':'Delete\x20an\x20existing\x20routine','blockedConnectionTypes':['webSocket'],'version':0x1,'inputs':{'routineId':{'routineId':!![],'validator':_0x4d0f('0x14')}},'outputExample':{},'tags':[_0x4d0f('0x7')],'run':function(_0x122e92,_0x4fcac4,_0x36127c){_0x122e92['routines'][_0x4d0f('0x1e')](_0x4fcac4['params'][_0x4d0f('0x16')])[_0x4d0f('0xd')](_0x125a4f=>{_0x4fcac4['response'][_0x4d0f('0x18')]=_0x125a4f;_0x36127c();})[_0x4d0f('0x19')](_0x3719c5=>{_0x36127c(_0x122e92[_0x4d0f('0x10')][_0x4d0f('0x1a')](_0x3719c5));})[_0x4d0f('0xd')](()=>{_0x122e92[_0x4d0f('0x11')](_0x122e92[_0x4d0f('0x12')][_0x4d0f('0xf')](_0x4d0f('0x1d'),JSON[_0x4d0f('0x1b')](_0x4fcac4['response'])),_0x4d0f('0x1c'));});}};exports[_0x4d0f('0x1f')]={'name':_0x4d0f('0x1f'),'description':_0x4d0f('0x20'),'blockedConnectionTypes':[_0x4d0f('0x6')],'version':0x1,'outputExample':{},'tags':[_0x4d0f('0x7')],'run':function(_0x2c7bbe,_0x2cd7a8,_0x294bf1){_0x2c7bbe[_0x4d0f('0xe')][_0x4d0f('0x21')]()['then'](_0x1164cd=>{_0x2cd7a8[_0x4d0f('0xf')][_0x4d0f('0xe')]=_0x1164cd;_0x294bf1();})[_0x4d0f('0x19')](_0x3e2d9a=>{_0x294bf1(_0x2c7bbe[_0x4d0f('0x10')]['handle'](_0x3e2d9a));})[_0x4d0f('0xd')](()=>{_0x2c7bbe[_0x4d0f('0x11')](_0x2c7bbe[_0x4d0f('0x12')][_0x4d0f('0xf')](_0x4d0f('0x22'),JSON[_0x4d0f('0x1b')](_0x2cd7a8[_0x4d0f('0xf')])),_0x4d0f('0x1c'));});}};exports[_0x4d0f('0x23')]={'name':_0x4d0f('0x23'),'description':'Retrieve\x20a\x20specific\x20routine','blockedConnectionTypes':[_0x4d0f('0x6')],'version':0x1,'inputs':{'routineId':{'required':!![],'validator':_0x4d0f('0x14')}},'outputExample':{},'tags':[_0x4d0f('0x7')],'run':function(_0x1cae34,_0x1f0139,_0x30fffe){_0x1cae34[_0x4d0f('0xe')][_0x4d0f('0x24')](_0x1f0139[_0x4d0f('0xa')][_0x4d0f('0x16')])['then'](_0x4e9e1f=>{_0x1f0139[_0x4d0f('0xf')][_0x4d0f('0xc')]=_0x4e9e1f;_0x30fffe();})['catch'](_0x49f4ff=>{_0x30fffe(_0x1cae34[_0x4d0f('0x10')][_0x4d0f('0x1a')](_0x49f4ff));})[_0x4d0f('0xd')](()=>{_0x1cae34[_0x4d0f('0x11')](_0x1cae34['formatters']['response'](_0x4d0f('0x23'),JSON[_0x4d0f('0x1b')](_0x1f0139[_0x4d0f('0xf')])),_0x4d0f('0x1c'));});}};exports[_0x4d0f('0x25')]={'name':_0x4d0f('0x25'),'description':_0x4d0f('0x26'),'blockedConnectionTypes':[_0x4d0f('0x6')],'version':0x1,'inputs':{'routineId':{'required':!![],'validator':'api.validators.routineId'}},'outputExample':{},'tags':[_0x4d0f('0x7')],'run':function(_0x25596b,_0x4f15bb,_0x3fd435){_0x25596b[_0x4d0f('0xe')]['retrieveById'](_0x4f15bb[_0x4d0f('0xa')][_0x4d0f('0x16')])[_0x4d0f('0xd')](_0x2e3a5e=>{if(!_0x2e3a5e){resolve(new Error(_0x4d0f('0x27')+_0x4f15bb[_0x4d0f('0xa')][_0x4d0f('0x16')]+'\x22',_0x4d0f('0x28')));}else{_0x25596b[_0x4d0f('0x29')]['promiseWaterfall'](_0x2e3a5e[_0x4d0f('0x2a')],function(_0x541f47){return new Promise((_0x23983a,_0x234ba5)=>{_0x25596b['devices'][_0x4d0f('0x24')](_0x541f47['deviceId'])[_0x4d0f('0xd')](_0x2070db=>{if(!_0x2070db){_0x23983a(new Error(_0x4d0f('0x2b')+_0x541f47[_0x4d0f('0x2c')]+'\x22',_0x4d0f('0x28')));}else{_0x25596b[_0x4d0f('0x2d')][_0x4d0f('0x24')](_0x2070db[_0x4d0f('0x2e')])[_0x4d0f('0xd')](_0x1c1493=>{var _0x1cc38e=new _0x25596b['devices'][_0x1c1493[(_0x4d0f('0x0'))]](_0x2070db['id'],_0x2070db[_0x4d0f('0x2f')]);if(!_0x1cc38e[_0x541f47[_0x4d0f('0x30')]])_0x23983a(new Error(_0x4d0f('0x31')+_0x541f47[_0x4d0f('0x30')]+_0x4d0f('0x32')+_0x2070db['id']+'\x22',_0x4d0f('0x28')));var _0x21ec39=![];switch(_0x541f47[_0x4d0f('0xa')][_0x4d0f('0x33')]){case 0x0:_0x21ec39=_0x1cc38e[_0x541f47[_0x4d0f('0x30')]]();break;case 0x1:_0x21ec39=_0x1cc38e[_0x541f47[_0x4d0f('0x30')]](_0x541f47[_0x4d0f('0xa')][0x0]);break;case 0x2:_0x21ec39=_0x1cc38e[_0x541f47[_0x4d0f('0x30')]](_0x541f47[_0x4d0f('0xa')][0x0],_0x541f47[_0x4d0f('0xa')][0x1]);break;}_0x2070db[_0x4d0f('0x2f')]=_0x1cc38e[_0x4d0f('0x34')]();_0x25596b[_0x4d0f('0x35')][_0x4d0f('0x17')](_0x2070db)[_0x4d0f('0xd')](_0x211fc4=>{var _0x562a7e=new _0x25596b[(_0x4d0f('0x36'))]['deviceLog'](new Date()[_0x4d0f('0x37')](),_0x2070db['id'],_0x541f47[_0x4d0f('0x0')],_0x541f47['params'],_0x21ec39);_0x25596b[_0x4d0f('0x38')][_0x4d0f('0x39')](_0x562a7e)[_0x4d0f('0xd')](_0x14fb4a=>{_0x23983a(_0x21ec39);})['catch'](_0x5dac96=>{_0x234ba5(_0x5dac96);});})[_0x4d0f('0x19')](_0x488efd=>{_0x234ba5(_0x488efd);});})[_0x4d0f('0x19')](_0x311f6b=>{_0x234ba5(_0x311f6b);});}})[_0x4d0f('0x19')](_0x57936f=>{_0x234ba5(_0x57936f);});});})[_0x4d0f('0xd')](_0x11a08c=>{var _0xe0540=_0x11a08c[_0x4d0f('0x3a')](_0x728651=>{return _0x728651 instanceof Error;});if(_0xe0540[_0x4d0f('0x33')]>0x0){var _0x5c8b86=[];_0xe0540[_0x4d0f('0x3b')](_0x1ab65e=>{_0x25596b[_0x4d0f('0x11')](_0x1ab65e[_0x4d0f('0x3c')],'warning');_0x5c8b86[_0x4d0f('0x3d')](_0x1ab65e['message']);});_0x3fd435(_0x25596b[_0x4d0f('0x10')][_0x4d0f('0x1a')]({'code':_0x25596b[_0x4d0f('0x10')][_0x4d0f('0x3e')][_0x4d0f('0x3f')],'description':_0x5c8b86}));}else{_0x4f15bb['response'][_0x4d0f('0x18')]=_0x11a08c;_0x3fd435();}});}})[_0x4d0f('0x19')](_0x2f6b2a=>{_0x3fd435(_0x25596b[_0x4d0f('0x10')][_0x4d0f('0x1a')](_0x2f6b2a));})[_0x4d0f('0xd')](()=>{_0x25596b[_0x4d0f('0x11')](_0x25596b[_0x4d0f('0x12')][_0x4d0f('0xf')](_0x4d0f('0x25'),JSON[_0x4d0f('0x1b')](_0x4f15bb[_0x4d0f('0xf')])),_0x4d0f('0x1c'));});}};