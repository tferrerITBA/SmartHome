var _0x2354=['insert','context','routine','name','fromDto','update','_id','remove','find','findOne','utils','promiseWaterfall','reduce','then','resolve','join','config','paths','dbName','loading\x20routine\x20database\x20[',']...','debug','log','error','routine\x20database\x20loaded','info','nedb','exports','routines','routines.db','models','toDto'];(function(_0x31589e,_0x2fde72){var _0x1ab046=function(_0x226453){while(--_0x226453){_0x31589e['push'](_0x31589e['shift']());}};_0x1ab046(++_0x2fde72);}(_0x2354,0xba));var _0xac53=function(_0x5a2ad5,_0x52fd45){_0x5a2ad5=_0x5a2ad5-0x0;var _0x1a3ce8=_0x2354[_0x5a2ad5];return _0x1a3ce8;};'use strict';var Datastore=require(_0xac53('0x0'));var Path=require('path');module[_0xac53('0x1')]={'initialize':function(_0x1ce16c,_0x6300e6){_0x1ce16c[_0xac53('0x2')]={'dbName':_0xac53('0x3'),'create':function(_0x50acf8){return new Promise((_0x1f8097,_0x291c6e)=>{var _0x4d687b=_0x1ce16c[_0xac53('0x4')]['routine'][_0xac53('0x5')](_0x50acf8);_0x1ce16c['db'][_0xac53('0x2')][_0xac53('0x6')](_0x4d687b,(_0x2cff89,_0x1e4a5a)=>{if(_0x2cff89){_0x2cff89[_0xac53('0x7')]={'entity':{'type':_0xac53('0x8'),'id':_0x4d687b[_0xac53('0x9')]}};_0x291c6e(_0x2cff89);}else{_0x1f8097(_0x1ce16c[_0xac53('0x4')][_0xac53('0x8')][_0xac53('0xa')](_0x1e4a5a));}});});},'update':function(_0x4d0b00){return new Promise((_0x35bcf1,_0x11c52d)=>{var _0x19712c=_0x1ce16c['models'][_0xac53('0x8')][_0xac53('0x5')](_0x4d0b00);_0x1ce16c['db'][_0xac53('0x2')][_0xac53('0xb')]({'_id':_0x19712c[_0xac53('0xc')]},_0x19712c,{},(_0x4b6f5a,_0x3b53af)=>{if(_0x4b6f5a){_0x4b6f5a[_0xac53('0x7')]={'entity':{'type':_0xac53('0x8'),'id':_0x19712c[_0xac53('0x9')]}};_0x11c52d(_0x4b6f5a);}else{_0x35bcf1(_0x3b53af==0x1);}});});},'delete':function(_0x486b5c){return new Promise((_0x3201fd,_0x3d57ba)=>{_0x1ce16c['db']['routines'][_0xac53('0xd')]({'_id':_0x486b5c},{},(_0x10a922,_0x316794)=>{if(_0x10a922){_0x3d57ba(_0x10a922);}else{_0x3201fd(_0x316794==0x1);}});});},'retrieveAll':function(){return new Promise((_0x326690,_0x1912e9)=>{_0x1ce16c['db'][_0xac53('0x2')][_0xac53('0xe')]({},(_0x3a9473,_0xd97b26)=>{if(_0x3a9473){_0x1912e9(_0x3a9473);}else{var _0x5e9fa6=_0xd97b26['map'](_0x3e6f72=>{return _0x1ce16c['models'][_0xac53('0x8')]['fromDto'](_0x3e6f72);});_0x326690(_0x5e9fa6);}});});},'retrieveById':function(_0x2a11d3){return new Promise((_0x3c1060,_0x118609)=>{_0x1ce16c['db'][_0xac53('0x2')][_0xac53('0xf')]({'_id':_0x2a11d3},(_0x424038,_0x18da20)=>{if(_0x424038){_0x118609(_0x424038);}else{_0x3c1060(_0x1ce16c['models'][_0xac53('0x8')][_0xac53('0xa')](_0x18da20));}});});}};_0x1ce16c[_0xac53('0x10')][_0xac53('0x11')]=function(_0x1050ea,_0x21b0c5){var _0x36610a=[];return _0x1050ea[_0xac53('0x12')](function(_0x55a534,_0x5f5b35){return _0x55a534[_0xac53('0x13')](function(){return _0x21b0c5(_0x5f5b35)[_0xac53('0x13')](function(_0x28be9c){_0x36610a['push'](_0x28be9c);return _0x36610a;});});},Promise[_0xac53('0x14')]());};return _0x6300e6();},'start':function(_0x345aeb,_0x5d435f){var _0xd37468=Path[_0xac53('0x15')](_0x345aeb[_0xac53('0x16')]['general'][_0xac53('0x17')]['db'][0x0],_0x345aeb[_0xac53('0x2')][_0xac53('0x18')]);_0x345aeb['log'](_0xac53('0x19')+_0xd37468+_0xac53('0x1a'),_0xac53('0x1b'));_0x345aeb['db']=_0x345aeb['db']||{};_0x345aeb['db'][_0xac53('0x2')]=new Datastore({'filename':_0xd37468,'autoload':!![]});_0x345aeb['db'][_0xac53('0x2')]['ensureIndex']({'fieldName':_0xac53('0x9'),'unique':!![]},_0x5032c6=>{if(_0x5032c6)_0x345aeb[_0xac53('0x1c')](_0x5032c6,_0xac53('0x1d'));});_0x345aeb[_0xac53('0x1c')](_0xac53('0x1e'),_0xac53('0x1f'));return _0x5d435f();}};